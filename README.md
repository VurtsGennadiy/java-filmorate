# filmorate (backend)
## Описание проекта
Проект представляет собой **Backend** часть приложения **filmorate**. Социальная сеть, которая поможет выбрать кино на основе того, какие фильмы вы и ваши друзья смотрите и какие оценки ставите.

### Стэк
- Язык программирования: Java
- Тестирование: JUnit 5
- Система сборки: Apache maven
- Фреймворк: SpringBoot
- Логирование: SLF4J
- Lombok

### Основные функциональности:
- Создание, редактирование пользователей.
- Создание, редактирование фильмов.
- Список друзей у пользователей.
- Рейтинг фильмов на основе лайков пользователей.
- Хранение данных во встроенной базе данных H2. [Описание базы данных](src/main/resources/DB-description.md)

### Групповой проект
В рамках группового проекта реализованы следующие функциональности:
* _Отзывы на фильмы_ - пользователи имеют возможность оставить отзыв на фильм. Отзыв можно пометить как положительный или отрицательный.
  Другие пользователи могут ставить лайк/дизлайк на отзыв.
* _Лента событий_ - появилась возможность отслеживать действия друзей на платформе, такие как: добавление, удаление друзей;
  оставленные лайки и отзывы на фильмы.
* _Рекомендации_ - реализован алгоритм рекомендаций фильмов, основанный на лайках пользователей с похожими вкусами.
* _Режиссёры_ - возможность добавлять информацию о режиссёрах фильма, а также фильтровать фильмы по режиссёру с сортировкой по году или популярности.
* _Общие фильмы_ - получить список общих с другом фильмов, с их сортировкой по популярности.
* _Поиск_ - поиск фильмов по подстроке в названии фильма и/или имени режиссёра.
* _Вывод самых популярных фильмов_ - вывод фильмов с наибольшим количеством лайков, с фильтрацией по году и/или по жанру.
* _Удаление фильма и пользователя по id_

## API
| URL                                                        | Http метод | Действие                                                                                                                                                          |
|------------------------------------------------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /films                                                     | POST       | Создать новый фильм                                                                                                                                               |
| /films                                                     | PUT        | Обновить информацию о фильме                                                                                                                                      |
| /films                                                     | GET        | Получить список всех фильмов                                                                                                                                      |
| /films/{id}                                                | DELETE     | Удалить фильм по id                                                                                                                                               |
| /films/{id}                                                | GET        | Получить информацию о фильме по id                                                                                                                                |
| /films/{id}/like/{userId}                                  | PUT        | Поставить лайк фильму                                                                                                                                             |
| /films/{id}/like/{userId}                                  | DELETE     | Убрать лайк фильма                                                                                                                                                |
| /films/popular?count={limit}&genreId={genreId}&year={year} | GET        | Получить список самых популярных фильмов                                                                                                                          |
| /films/common?userId={userId}&friendId={friendId}          | GET        | Получить список общих фильмов                                                                                                                                     |
| /films/search?query={query}&by=[director,title]            | GET        | Поиск фильмов. Параметры строки запроса: query - строка для поиска, by - director(поиск по режиссёру), title(поиск по названию), либо оба значения через запятую. |
| /films/director/{directorId}?sortBy=[year,likes]           | GET        | Получить список фильмов режиссёра, отсортированный по лайкам или году выпуска.                                                                                    |
| /directors                                                 | POST       | Создание режиссёра                                                                                                                                                |
| /directors                                                 | PUT        | Изменение режиссёра                                                                                                                                               |
| /directors                                                 | GET        | Получить всех режиссёров                                                                                                                                          |
| /directors/{id}                                            | GET        | Получить режиссёра по id                                                                                                                                          |
| /directors/{id}                                            | DELETE     | Удалить режиссёра по id                                                                                                                                           |
| /users                                                     | POST       | Создать нового пользователя                                                                                                                                       |
| /users                                                     | PUT        | Обновить информацию о пользователе                                                                                                                                |
| /users                                                     | GET        | Получить список всех пользователей                                                                                                                                |
| /users/{id}                                                | GET        | Получить информацию о пользователе по id                                                                                                                          |
| /users/{id}                                                | DELETE     | Удалить пользователя по id                                                                                                                                        |
| /users/{id}/friends                                        | GET        | Получить список друзей пользователя                                                                                                                               |
| /users/{id}/friends/{friendId}                             | PUT        | Добавить пользователя в друзья                                                                                                                                    |
| /users/{id}/friends/{friendId}                             | DELETE     | Удалить пользователя из друзей                                                                                                                                    |
| /users/{id}/friends/common/{otherId}                       | GET        | Получить список общих друзей пользователей                                                                                                                        |
| /users/{id}/recommendations                                | GET        | Получить список рекомендованных фильмов                                                                                                                           |
| /users/{id}/feed                                           | GET        | Получить ленту событий для пользователя                                                                                                                           |
| /genres                                                    | GET        | Получить список жанров фильмов                                                                                                                                    |
| /genres/{id}                                               | GET        | Получить жанр по id жанра                                                                                                                                         |
| /mpa                                                       | GET        | Получить список рейтингов MPA                                                                                                                                     |
| /mpa/{id}                                                  | GET        | Получить рейтинг MPA по id рейтинга                                                                                                                               |
| /reviews                                                   | POST       | Добавить новый отзыв на фильм                                                                                                                                     |
| /reviews                                                   | PUT        | Обновить существующий отзыв на фильм                                                                                                                              |
| /reviews/{id}                                              | DELETE     | Удалить отзыв на фильм по id отзыва                                                                                                                               |
| /reviews/{id}                                              | GET        | Получить отзыв на фильм по id отзыва                                                                                                                              |
| /reviews?filmId={filmId}&count={count}                     | GET        | Получить все отзывы на фильм по id фильма. Количество по умолчанию 10. Фильм если не указан, то все фильмы.                                                       |
| /reviews/{id}/like/{userId}                                | PUT        | Пользователь ставит лайк отзыву                                                                                                                                   |
| /reviews/{id}/dislike/{userId}                             | PUT        | Пользователь ставит дизлайк отзыву                                                                                                                                |
| /reviews/{id}/like/{userId}                                | DELETE     | Пользователь удаляет лайк отзыву                                                                                                                                  |
| /reviews/{id}/dislike/{userId}                             | DELETE     | Пользователь удаляет дизлайк отзыву                                                                                                                               |

<details>
  <summary> Формат JSON для создания фильма</summary>

```
  {
    "name": "Аватар", // not null
    "description": "Бывший морпех Джейк Салли...",
    "releaseDate": "2009-12-10",
    "duration": 162, // в минутах
    "mpa": {"id": 3},
    "genres": [{"id": 2}, {"id": 6}] // список жанров
    "director": [{ "id": 1}] // список режиссёров
  }
```
</details>


<details>
    <summary>Формат JSON для создания режиссёра </summary>
    
    ```
    {
    "name": "New director"
    }
    ```
</details>


<details>
  <summary> Формат JSON для создания пользователя</summary>

  ```
  {
    "email": "johnsmith@example.com", // not null
    "login": "smith",
    "name": "John Smith",
    "birthday": "1990-01-01"
  }
  ```
</details>

<details>
    <summary> Формат JSON с которым работают эндпоинты отзывов на фильмы </summary>

    ```
    {
        "reviewId": 123,
        "content": "This film is sooo baad.",
        "isPositive": false,
        "userId": 123, // Пользователь
        "filmId": 2, // Фильм
        "useful": 20 // рейтинг полезности 
    }
    ```
</details>


**Dream Team:** [Вурц Геннадий](https://github.com/VurtsGennadiy/), [Дарья Головина](https://github.com/vivena600),
[Вячеслав Гонтарев](https://github.com/VyacheslavGontarev), [Алексей Буренков](https://github.com/alxb2la) 2025 год. 